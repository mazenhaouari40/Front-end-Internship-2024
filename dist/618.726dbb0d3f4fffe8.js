"use strict";(self.webpackChunkmantis_free_version=self.webpackChunkmantis_free_version||[]).push([[618],{8618:(v,u,i)=>{i.r(u),i.d(u,{UserFormComponent:()=>M});var d=i(177),g=i(1626),n=i(4341),p=i(904),_=i(4322),c=i(2389),e=i(3953),f=i(34),h=i(5794),F=i(5639);function C(s,m){if(1&s&&e.nrm(0,"app-spinner",23),2&s){const o=e.XpG();e.Y8G("backgroundColor","#1890ff")("spinner",o.Spinkit.skLine)}}function E(s,m){if(1&s&&(e.j41(0,"option",28),e.EFF(1),e.k0s()),2&s){const o=m.$implicit;e.Y8G("value",o.idmanager),e.R7$(),e.SpI(" ",o.nommanager," ")}}function b(s,m){if(1&s&&(e.j41(0,"div",4)(1,"label",24),e.EFF(2,"Manager"),e.k0s(),e.j41(3,"select",25)(4,"option",26),e.EFF(5,"Select Manager"),e.k0s(),e.DNE(6,E,2,2,"option",27),e.k0s()()),2&s){const o=e.XpG();e.R7$(6),e.Y8G("ngForOf",o.managerList)}}let M=(()=>{class s{constructor(o,a,r,l){this.service=o,this.route=a,this.fb=r,this.toastr=l,this.userdata=[],this.selectedRole="",this.isLoading=!1,this.Spinkit=_.N,this.userForm=this.fb.group({nom:["",n.k0.required],email:[[n.k0.required,n.k0.email]],num_tel:["",n.k0.required],password:["",n.k0.required],image:[null],role:["",n.k0.required],manager:[""]}),this.userForm.get("role")?.valueChanges.subscribe(t=>{this.selectedRole=t,this.updateManagerField()})}updateManagerField(){const o=this.userForm.get("manager");"collaborateur"===this.selectedRole?o?.setValidators(n.k0.required):(o?.clearValidators(),o?.setValue(null)),o?.updateValueAndValidity()}ngOnInit(){this.service.getManagers(this.route.snapshot.params.id).subscribe(r=>{this.managerList=r});let a=this.route.snapshot.params.id;this.isLoading=!0,this.service.getUser(a).subscribe(r=>{this.userdata=r,this.isLoading=!1},r=>{console.error("Error fetching users:",r),this.isLoading=!1})}onSubmit(){if(this.userForm.valid){const o=new FormData;let a=this.route.snapshot.params.id;const r={id:a,nom:this.userForm.get("nom")?.value,email:this.userForm.get("email")?.value,num_tel:this.userForm.get("num_tel")?.value,password:this.userForm.get("password")?.value,role:this.userForm.get("role")?.value,..."collaborateur"===this.selectedRole?{manager:{id:parseInt(this.userForm.get("manager")?.value)}}:{}};console.log("id  "+a),console.log(r),o.append("user",JSON.stringify(r)),o.append("file",this.userForm.get("image")?.value),this.service.EditProfile_admin(o,a).subscribe(()=>{this.toastr.success("User Updated successfully")},l=>{console.error("Error!",l.message),this.toastr.error(l.error.message)})}else console.log("Form is invalid")}onFileChange(o){this.userForm.patchValue({image:o.target.files[0]})}static#e=this.\u0275fac=function(a){return new(a||s)(e.rXU(p.N),e.rXU(f.nX),e.rXU(n.ok),e.rXU(h.tw))};static#r=this.\u0275cmp=e.VBU({type:s,selectors:[["app-user-form"]],standalone:!0,features:[e.Jv_([p.N,g.Qq]),e.aNF],decls:41,vars:8,consts:[[3,"backgroundColor","spinner",4,"ngIf"],[1,"container"],[1,"form-container"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","nom"],["id","nom","required","","formControlName","nom",1,"form-control",3,"ngModelChange","ngModel"],["for","e_mail"],["id","e_mail","name","e_mail","required","","formControlName","email",1,"form-control",3,"ngModelChange","ngModel"],["for","num_tel"],["id","num_tel","name","num_tel","required","","formControlName","num_tel",1,"form-control",3,"ngModelChange","ngModel"],["for","password"],["type","password","name","password","id","password","formControlName","password","formControlName","password",1,"form-control"],["for","image"],["type","file","id","image","name","image","accept","image/*",1,"form-control",3,"change"],["for","role"],["id","role","name","role","required","","formControlName","role",1,"form-control",3,"ngModelChange","ngModel"],["value","manager"],["value","admin"],["value","collaborateur"],["class","form-group",4,"ngIf"],[1,"button-group"],["type","submit",1,"btn","btn-submit",3,"disabled"],[3,"backgroundColor","spinner"],["for","manager"],["id","manager","name","manager","formControlName","manager",1,"form-control"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(a,r){1&a&&(e.DNE(0,C,1,2,"app-spinner",0),e.j41(1,"div",1)(2,"div",2)(3,"h1"),e.EFF(4,"Update User"),e.k0s(),e.nrm(5,"br"),e.j41(6,"form",3),e.bIt("ngSubmit",function(){return r.onSubmit()}),e.j41(7,"div",4)(8,"label",5),e.EFF(9,"Nom"),e.k0s(),e.j41(10,"input",6),e.mxI("ngModelChange",function(t){return e.DH7(r.userdata.nom,t)||(r.userdata.nom=t),t}),e.k0s()(),e.j41(11,"div",4)(12,"label",7),e.EFF(13,"E-mail"),e.k0s(),e.j41(14,"input",8),e.mxI("ngModelChange",function(t){return e.DH7(r.userdata.email,t)||(r.userdata.email=t),t}),e.k0s()(),e.j41(15,"div",4)(16,"label",9),e.EFF(17,"Num\xe9ro de T\xe9l\xe9phone"),e.k0s(),e.j41(18,"input",10),e.mxI("ngModelChange",function(t){return e.DH7(r.userdata.num_tel,t)||(r.userdata.num_tel=t),t}),e.k0s()(),e.j41(19,"div",4)(20,"label",11),e.EFF(21,"Password"),e.k0s(),e.nrm(22,"input",12),e.k0s(),e.j41(23,"div",4)(24,"label",13),e.EFF(25,"Image"),e.k0s(),e.j41(26,"input",14),e.bIt("change",function(t){return r.onFileChange(t)}),e.k0s()(),e.j41(27,"div",4)(28,"label",15),e.EFF(29,"Role"),e.k0s(),e.j41(30,"select",16),e.mxI("ngModelChange",function(t){return e.DH7(r.selectedRole,t)||(r.selectedRole=t),t}),e.j41(31,"option",17),e.EFF(32,"Manager"),e.k0s(),e.j41(33,"option",18),e.EFF(34,"Admin"),e.k0s(),e.j41(35,"option",19),e.EFF(36,"Collaborateur"),e.k0s()()(),e.DNE(37,b,7,1,"div",20),e.j41(38,"div",21)(39,"button",22),e.EFF(40,"Editer"),e.k0s()()()()()),2&a&&(e.Y8G("ngIf",r.isLoading),e.R7$(6),e.Y8G("formGroup",r.userForm),e.R7$(4),e.R50("ngModel",r.userdata.nom),e.R7$(4),e.R50("ngModel",r.userdata.email),e.R7$(4),e.R50("ngModel",r.userdata.num_tel),e.R7$(12),e.R50("ngModel",r.selectedRole),e.R7$(7),e.Y8G("ngIf","collaborateur"===r.selectedRole),e.R7$(2),e.Y8G("disabled",r.userForm.invalid))},dependencies:[d.pM,g.q1,n.YN,n.qT,n.xH,n.y7,n.me,n.wz,n.BC,n.cb,n.YS,d.bT,n.X1,n.j4,n.JD,c.G,F.t],styles:[".button-group[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:15px}.btn-submit[_ngcontent-%COMP%]{background:linear-gradient(90deg,#007bff,#0056b3);color:#fff;border:none;border-radius:8px;font-size:18px;padding:10px 32px;width:400px;height:50px;cursor:pointer;transition:all .3s ease;box-shadow:0 6px 12px #00000026}.btn-submit[_ngcontent-%COMP%]:hover{background:linear-gradient(90deg,#0056b3,#003d80);transform:scale(1.05)}.btn-submit[_ngcontent-%COMP%]:active{background:linear-gradient(90deg,#003d80,#0056b3);transform:scale(.95)}"]})}return s})()}}]);