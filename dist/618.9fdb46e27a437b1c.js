"use strict";(self.webpackChunkmantis_free_version=self.webpackChunkmantis_free_version||[]).push([[618],{8618:(b,m,l)=>{l.r(m),l.d(m,{UserFormComponent:()=>F});var u=l(177),d=l(1626),n=l(4341),g=l(904),e=l(3953),_=l(34),c=l(5794);function f(s,p){if(1&s&&(e.j41(0,"option",26),e.EFF(1),e.k0s()),2&s){const o=p.$implicit;e.Y8G("value",o.idmanager),e.R7$(),e.SpI(" ",o.nommanager," ")}}function h(s,p){if(1&s&&(e.j41(0,"div",3)(1,"label",22),e.EFF(2,"Manager"),e.k0s(),e.j41(3,"select",23)(4,"option",24),e.EFF(5,"Select Manager"),e.k0s(),e.DNE(6,f,2,2,"option",25),e.k0s()()),2&s){const o=e.XpG();e.R7$(6),e.Y8G("ngForOf",o.managerList)}}let F=(()=>{class s{constructor(o,a,r,i){this.service=o,this.route=a,this.fb=r,this.toastr=i,this.userdata=[],this.selectedRole="",this.userForm=this.fb.group({nom:["",n.k0.required],email:[[n.k0.required,n.k0.email]],num_tel:["",n.k0.required],password:["",n.k0.required],image:[null],role:["",n.k0.required],manager:[""]}),this.userForm.get("role")?.valueChanges.subscribe(t=>{this.selectedRole=t,this.updateManagerField()})}updateManagerField(){const o=this.userForm.get("manager");"collaborateur"===this.selectedRole?o?.setValidators(n.k0.required):(o?.clearValidators(),o?.setValue(null)),o?.updateValueAndValidity()}ngOnInit(){this.service.getManagers(this.route.snapshot.params.id).subscribe(r=>{this.managerList=r}),this.service.getUser(this.route.snapshot.params.id).subscribe(r=>{this.userdata=r},r=>{console.error("Error fetching users:",r)})}onSubmit(){if(this.userForm.valid){const o=new FormData;let a=this.route.snapshot.params.id;const r={id:a,nom:this.userForm.get("nom")?.value,num_tel:this.userForm.get("num_tel")?.value,password:this.userForm.get("password")?.value,role:this.userForm.get("role")?.value,..."collaborateur"===this.selectedRole?{manager:{id:parseInt(this.userForm.get("manager")?.value)}}:{}};console.log("id  "+a),console.log(r),o.append("user",JSON.stringify(r)),o.append("file",this.userForm.get("image")?.value),this.service.EditProfile_admin(o,a).subscribe(()=>{this.toastr.success("User Updated successfully")},i=>{console.error("Error!",i),this.toastr.error(i)})}else console.log("Form is invalid")}onFileChange(o){this.userForm.patchValue({image:o.target.files[0]})}static#e=this.\u0275fac=function(a){return new(a||s)(e.rXU(g.N),e.rXU(_.nX),e.rXU(n.ok),e.rXU(c.tw))};static#r=this.\u0275cmp=e.VBU({type:s,selectors:[["app-user-form"]],standalone:!0,features:[e.Jv_([g.N,d.Qq]),e.aNF],decls:40,vars:7,consts:[[1,"container"],[1,"form-container"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","nom"],["id","nom","required","","formControlName","nom",1,"form-control",3,"ngModelChange","ngModel"],["for","e_mail"],["id","e_mail","name","e_mail","required","","formControlName","email","readonly","",1,"form-control",3,"ngModelChange","ngModel"],["for","num_tel"],["id","num_tel","name","num_tel","required","","formControlName","num_tel",1,"form-control",3,"ngModelChange","ngModel"],["for","password"],["type","password","name","password","id","password","formControlName","password","formControlName","password",1,"form-control"],["for","image"],["type","file","id","image","name","image","accept","image/*",1,"form-control",3,"change"],["for","role"],["id","role","name","role","required","","formControlName","role",1,"form-control",3,"ngModelChange","ngModel"],["value","manager"],["value","admin"],["value","collaborateur"],["class","form-group",4,"ngIf"],[1,"button-group"],["type","submit",1,"btn","btn-submit",3,"disabled"],["for","manager"],["id","manager","name","manager","formControlName","manager",1,"form-control"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(a,r){1&a&&(e.j41(0,"div",0)(1,"div",1)(2,"h1"),e.EFF(3,"Update User"),e.k0s(),e.nrm(4,"br"),e.j41(5,"form",2),e.bIt("ngSubmit",function(){return r.onSubmit()}),e.j41(6,"div",3)(7,"label",4),e.EFF(8,"Nom"),e.k0s(),e.j41(9,"input",5),e.mxI("ngModelChange",function(t){return e.DH7(r.userdata.nom,t)||(r.userdata.nom=t),t}),e.k0s()(),e.j41(10,"div",3)(11,"label",6),e.EFF(12,"E-mail"),e.k0s(),e.j41(13,"input",7),e.mxI("ngModelChange",function(t){return e.DH7(r.userdata.email,t)||(r.userdata.email=t),t}),e.k0s()(),e.j41(14,"div",3)(15,"label",8),e.EFF(16,"Num\xe9ro de T\xe9l\xe9phone"),e.k0s(),e.j41(17,"input",9),e.mxI("ngModelChange",function(t){return e.DH7(r.userdata.num_tel,t)||(r.userdata.num_tel=t),t}),e.k0s()(),e.j41(18,"div",3)(19,"label",10),e.EFF(20,"Password"),e.k0s(),e.nrm(21,"input",11),e.k0s(),e.j41(22,"div",3)(23,"label",12),e.EFF(24,"Image"),e.k0s(),e.j41(25,"input",13),e.bIt("change",function(t){return r.onFileChange(t)}),e.k0s()(),e.j41(26,"div",3)(27,"label",14),e.EFF(28,"Role"),e.k0s(),e.j41(29,"select",15),e.mxI("ngModelChange",function(t){return e.DH7(r.selectedRole,t)||(r.selectedRole=t),t}),e.j41(30,"option",16),e.EFF(31,"Manager"),e.k0s(),e.j41(32,"option",17),e.EFF(33,"Admin"),e.k0s(),e.j41(34,"option",18),e.EFF(35,"Collaborateur"),e.k0s()()(),e.DNE(36,h,7,1,"div",19),e.j41(37,"div",20)(38,"button",21),e.EFF(39,"Editer"),e.k0s()()()()()),2&a&&(e.R7$(5),e.Y8G("formGroup",r.userForm),e.R7$(4),e.R50("ngModel",r.userdata.nom),e.R7$(4),e.R50("ngModel",r.userdata.email),e.R7$(4),e.R50("ngModel",r.userdata.num_tel),e.R7$(12),e.R50("ngModel",r.selectedRole),e.R7$(7),e.Y8G("ngIf","collaborateur"===r.selectedRole),e.R7$(2),e.Y8G("disabled",r.userForm.invalid))},dependencies:[u.pM,d.q1,n.YN,n.qT,n.xH,n.y7,n.me,n.wz,n.BC,n.cb,n.YS,u.bT,n.X1,n.j4,n.JD],styles:[".button-group[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:15px}.btn-submit[_ngcontent-%COMP%]{background:linear-gradient(90deg,#007bff,#0056b3);color:#fff;border:none;border-radius:8px;font-size:18px;padding:10px 32px;width:400px;height:50px;cursor:pointer;transition:all .3s ease;box-shadow:0 6px 12px #00000026}.btn-submit[_ngcontent-%COMP%]:hover{background:linear-gradient(90deg,#0056b3,#003d80);transform:scale(1.05)}.btn-submit[_ngcontent-%COMP%]:active{background:linear-gradient(90deg,#003d80,#0056b3);transform:scale(.95)}"]})}return s})()}}]);